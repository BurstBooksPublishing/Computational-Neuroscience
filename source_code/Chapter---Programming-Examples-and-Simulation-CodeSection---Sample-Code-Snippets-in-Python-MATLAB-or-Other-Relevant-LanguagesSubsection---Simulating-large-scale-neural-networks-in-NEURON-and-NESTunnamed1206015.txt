import nest
import nest.voltage_trace

# Initialize NEST
nest.ResetKernel()

# Set parameters
num_neurons = 10000
sim_time = 1000.0  # Simulation time (ms)

# Create neurons and devices
neurons = nest.Create('iaf_psc_alpha', num_neurons)
spike_detector = nest.Create('spike_detector')
voltmeter = nest.Create('voltmeter')

# Set neuron parameters
nest.SetStatus(neurons, {'E_L': -70.0, 'V_th': -55.0, 'V_reset': -70.0, 'tau_m': 20.0})

# Connect neurons with synapses
nest.Connect(neurons, spike_detector)
nest.Connect(voltmeter, neurons[0])  # Record voltage of the first neuron

# Run simulation
nest.Simulate(sim_time)

# Plot results
nest.voltage_trace.from_device(voltmeter)
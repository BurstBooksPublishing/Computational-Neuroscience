% Parameters
tau_m = 20.0;  % Membrane time constant (ms)
R_m = 1.0;     % Membrane resistance (MÎ©)
V_rest = -65.0;  % Resting potential (mV)
V_thresh = -50.0;  % Threshold potential (mV)
V_reset = -70.0;  % Reset potential (mV)
dt = 0.1;      % Time step (ms)
T = 1000;      % Total simulation time (ms)
I_ext = 1.5;   % External current (nA)

% Initialize variables
V = V_rest;    % Membrane potential
t = 0:dt:T;    % Time array
V_trace = zeros(1, length(t));  % Membrane potential trace

% Simulation loop
for i = 1:length(t)
    if V >= V_thresh
        V = V_reset;  % Reset potential after spike
    end
    dV = (- (V - V_rest) + R_m * I_ext) * (dt / tau_m);
    V = V + dV;
    V_trace(i) = V;
end

% Plot results
plot(t, V_trace);
xlabel('Time (ms)');
ylabel('Membrane Potential (mV)');
title('Integrate-and-Fire Neuron Model');
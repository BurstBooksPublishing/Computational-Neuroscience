def runge_kutta_4(f, y0, t):
    n = len(t)
    y = np.zeros((n, len(y0)))
    y[0] = y0
    for i in range(n - 1):
        h = t[i+1] - t[i]
        k1 = f(y[i], t[i])
        k2 = f(y[i] + 0.5 * h * k1, t[i] + 0.5 * h)
        k3 = f(y[i] + 0.5 * h * k2, t[i] + 0.5 * h)
        k4 = f(y[i] + h * k3, t[i] + h)
        y[i+1] = y[i] + (h / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)
    return y
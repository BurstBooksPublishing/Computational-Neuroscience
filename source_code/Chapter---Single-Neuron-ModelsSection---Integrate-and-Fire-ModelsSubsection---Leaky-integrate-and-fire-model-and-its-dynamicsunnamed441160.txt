import numpy as np

def lif_neuron(I, dt, tau_m, R_m, V_rest, V_th, V_reset, tau_ref):
    T = len(I)
    V = np.zeros(T)
    spike_times = []
    ref_time = 0

    for t in range(1, T):
        if ref_time > 0:
            V[t] = V_reset
            ref_time -= 1
        else:
            dV = (-(V[t-1] - V_rest) + R_m * I[t-1]) * dt / tau_m
            V[t] = V[t-1] + dV
            if V[t] >= V_th:
                V[t] = V_reset
                spike_times.append(t * dt)
                ref_time = int(tau_ref / dt)

    return V, spike_times
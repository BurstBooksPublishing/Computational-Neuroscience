from scipy.integrate import solve_ivp
import matplotlib.pyplot as plt

# Parameters
C_m = 1.0  # Membrane capacitance (uF/cm^2)
g_Na = 120.0  # Sodium conductance (mS/cm^2)
g_K = 36.0  # Potassium conductance (mS/cm^2)
g_L = 0.3  # Leak conductance (mS/cm^2)
E_Na = 50.0  # Sodium reversal potential (mV)
E_K = -77.0  # Potassium reversal potential (mV)
E_L = -54.387  # Leak reversal potential (mV)
I_ext = 10.0  # External current (uA/cm^2)

# Initial conditions
y0 = [-65, 0.05, 0.6, 0.32]

# Time span
t_span = (0, 50)  # Simulation time (ms)

# Solve ODE
sol = solve_ivp(hodgkin_huxley, t_span, y0, args=(C_m, g_Na, g_K, g_L, E_Na, E_K, E_L, I_ext), t_eval=np.linspace(0, 50, 1000))

# Plot results
plt.plot(sol.t, sol.y[0], label='Membrane Potential (mV)')
plt.xlabel('Time (ms)')
plt.ylabel('V (mV)')
plt.legend()
plt.show()
import numpy as np
import matplotlib.pyplot as plt

# Parameters
Cm = 1.0  # Membrane capacitance (uF/cm^2)
g_Na = 120.0  # Sodium conductance (mS/cm^2)
g_K = 36.0  # Potassium conductance (mS/cm^2)
g_L = 0.3  # Leak conductance (mS/cm^2)
E_Na = 50.0  # Sodium reversal potential (mV)
E_K = -77.0  # Potassium reversal potential (mV)
E_L = -54.387  # Leak reversal potential (mV)
I_ext = 10.0  # External current (uA/cm^2)

# Initial conditions
V = -65.0  # Membrane potential (mV)
m = 0.05  # Sodium activation gating variable
h = 0.6  # Sodium inactivation gating variable
n = 0.32  # Potassium activation gating variable

# Time parameters
dt = 0.01  # Time step (ms)
t_max = 100.0  # Total simulation time (ms)
time = np.arange(0, t_max, dt)

# Arrays to store results
V_trace = []

# Simulation loop
for t in time:
    # Compute ionic currents
    I_Na = g_Na * m**3 * h * (V - E_Na)
    I_K = g_K * n**4 * (V - E_K)
    I_L = g_L * (V - E_L)
    
    # Update membrane potential
    dV_dt = (I_ext - I_Na - I_K - I_L) / Cm
    V += dV_dt * dt
    
    # Update gating variables
    # (Equations for m, h, n omitted for brevity)
    
    # Store results
    V_trace.append(V)

# Plot results
plt.plot(time, V_trace)
plt.xlabel('Time (ms)')
plt.ylabel('Membrane Potential (mV)')
plt.title('Conductance-Based Model with Multiple Ionic Currents')
plt.show()
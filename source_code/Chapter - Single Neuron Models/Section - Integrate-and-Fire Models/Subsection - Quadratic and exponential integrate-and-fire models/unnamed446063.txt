def quadratic_integrate_and_fire(V, V_r, V_t, a, I, dt):
    dV = (a * (V - V_r) * (V - V_t) + I) * dt / tau_m
    V += dV
    if V >= V_peak:
        V = V_reset
    return V